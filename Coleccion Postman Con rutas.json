{
  "info": {
    "name": "Cucharita API",
    "description": "Collection para testear la API de Cucharita - Recipe Management System",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "base_url",
      "value": "https://proyectodesarrollo-0c7d.onrender.com",
      "type": "string"
    },
    {
      "key": "access_token",
      "value": "",
      "type": "string"
    },
    {
      "key": "recipe_id",
      "value": "",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "Auth",
      "item": [
        {
          "name": "Register User",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const response = pm.response.json();",
                  "    if (response.session && response.session.access_token) {",
                  "        pm.collectionVariables.set('access_token', response.session.access_token);",
                  "        console.log('Token guardado:', response.session.access_token);",
                  "    }",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"test@example.com\",\n  \"password\": \"password123\",\n  \"name\": \"Test User\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/auth/register",
              "host": ["{{base_url}}"],
              "path": ["api", "auth", "register"]
            },
            "description": "Registra un nuevo usuario en el sistema"
          },
          "response": []
        },
        {
          "name": "Login",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    pm.collectionVariables.set('access_token', response.access_token);",
                  "    console.log('Token guardado:', response.access_token);",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"test@example.com\",\n  \"password\": \"password123\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/auth/login",
              "host": ["{{base_url}}"],
              "path": ["api", "auth", "login"]
            },
            "description": "Inicia sesión y obtiene el access token"
          },
          "response": []
        },
        {
          "name": "Get Current User",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/auth/me",
              "host": ["{{base_url}}"],
              "path": ["api", "auth", "me"]
            },
            "description": "Obtiene información del usuario actual"
          },
          "response": []
        },
        {
          "name": "Logout",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/auth/logout",
              "host": ["{{base_url}}"],
              "path": ["api", "auth", "logout"]
            },
            "description": "Cierra la sesión del usuario"
          },
          "response": []
        }
      ]
    },
    {
      "name": "Recipes",
      "item": [
        {
          "name": "Get All Recipes",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/recipes",
              "host": ["{{base_url}}"],
              "path": ["api", "recipes"]
            },
            "description": "Obtiene todas las recetas del sistema"
          },
          "response": []
        },
        {
          "name": "Get My Recipes",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/recipes/my-recipes",
              "host": ["{{base_url}}"],
              "path": ["api", "recipes", "my-recipes"]
            },
            "description": "Obtiene solo las recetas del usuario actual"
          },
          "response": []
        },
        {
          "name": "Get Favorites",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/recipes/favorites",
              "host": ["{{base_url}}"],
              "path": ["api", "recipes", "favorites"]
            },
            "description": "Obtiene las recetas favoritas del usuario"
          },
          "response": []
        },
        {
          "name": "Search Recipes",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/recipes/search?query=pasta",
              "host": ["{{base_url}}"],
              "path": ["api", "recipes", "search"],
              "query": [
                {
                  "key": "query",
                  "value": "pasta",
                  "description": "Término de búsqueda"
                }
              ]
            },
            "description": "Busca recetas por título o descripción"
          },
          "response": []
        },
        {
          "name": "Get Recipe by ID",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/recipes/{{recipe_id}}",
              "host": ["{{base_url}}"],
              "path": ["api", "recipes", "{{recipe_id}}"]
            },
            "description": "Obtiene una receta específica por su ID"
          },
          "response": []
        },
        {
          "name": "Create Recipe",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const response = pm.response.json();",
                  "    if (response.recipe && response.recipe.id) {",
                  "        pm.collectionVariables.set('recipe_id', response.recipe.id);",
                  "        console.log('Recipe ID guardado:', response.recipe.id);",
                  "    }",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"Pasta Carbonara\",\n  \"description\": \"Deliciosa pasta italiana con salsa cremosa\",\n  \"ingredients\": [\n    \"400g de pasta\",\n    \"200g de tocino\",\n    \"3 huevos\",\n    \"100g de queso parmesano\",\n    \"Sal y pimienta\"\n  ],\n  \"steps\": [\n    \"Hervir la pasta en agua con sal\",\n    \"Freír el tocino hasta que esté crujiente\",\n    \"Batir los huevos con el queso\",\n    \"Mezclar la pasta con el tocino\",\n    \"Agregar la mezcla de huevo y servir\"\n  ]\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/recipes",
              "host": ["{{base_url}}"],
              "path": ["api", "recipes"]
            },
            "description": "Crea una nueva receta"
          },
          "response": []
        },
        {
          "name": "Update Recipe",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"Pasta Carbonara Mejorada\",\n  \"description\": \"Versión mejorada de la receta clásica\",\n  \"ingredients\": [\n    \"400g de pasta\",\n    \"250g de pancetta\",\n    \"4 huevos\",\n    \"150g de queso pecorino\",\n    \"Sal y pimienta negra recién molida\"\n  ],\n  \"steps\": [\n    \"Hervir la pasta al dente\",\n    \"Dorar la pancetta\",\n    \"Batir huevos con queso\",\n    \"Mezclar todo rápidamente\",\n    \"Servir inmediatamente\"\n  ]\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/recipes/{{recipe_id}}",
              "host": ["{{base_url}}"],
              "path": ["api", "recipes", "{{recipe_id}}"]
            },
            "description": "Actualiza una receta existente"
          },
          "response": []
        },
        {
          "name": "Toggle Favorite",
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/recipes/{{recipe_id}}/favorite",
              "host": ["{{base_url}}"],
              "path": ["api", "recipes", "{{recipe_id}}", "favorite"]
            },
            "description": "Marca o desmarca una receta como favorita"
          },
          "response": []
        },
        {
          "name": "Upload Image",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "image",
                  "type": "file",
                  "src": "",
                  "description": "Selecciona una imagen desde tu computadora"
                }
              ]
            },
            "url": {
              "raw": "{{base_url}}/api/recipes/{{recipe_id}}/image",
              "host": ["{{base_url}}"],
              "path": ["api", "recipes", "{{recipe_id}}", "image"]
            },
            "description": "Sube una imagen para la receta"
          },
          "response": []
        },
        {
          "name": "Delete Recipe",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/recipes/{{recipe_id}}",
              "host": ["{{base_url}}"],
              "path": ["api", "recipes", "{{recipe_id}}"]
            },
            "description": "Elimina una receta"
          },
          "response": []
        }
      ]
    },
    {
      "name": "Health Check",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{base_url}}/",
          "host": ["{{base_url}}"],
          "path": [""]
        },
        "description": "Verifica que la API esté funcionando"
      },
      "response": []
    }
  ]
}
